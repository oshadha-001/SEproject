<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Promotion Details</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        body { background-color: #f8f9fa; }
        .navbar-custom { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }
        .detail-container { background: white; padding: 40px; border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); max-width: 900px; margin: 30px auto; }
        .info-row { padding: 15px; border-bottom: 1px solid #dee2e6; }
        .info-row:last-child { border-bottom: none; }
        .info-label { font-weight: 600; color: #495057; width: 200px; display: inline-block; }
        .info-value { color: #212529; }
        .status-sent { background: linear-gradient(135deg, #28a745 0%, #20c997 100%); }
        .status-draft { background: linear-gradient(135deg, #6c757d 0%, #495057 100%); }
        .status-scheduled { background: linear-gradient(135deg, #ffc107 0%, #fd7e14 100%); }
        .status-cancelled { background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); }
        .status-badge { padding: 30px; border-radius: 10px; color: white; text-align: center; margin-bottom: 30px; }
        .content-box { background-color: #f8f9fa; padding: 20px; border-radius: 5px; border-left: 4px solid #667eea; margin: 15px 0; }
    </style>
</head>
<body>
<nav class="navbar navbar-dark navbar-custom mb-4">
    <div class="container-fluid">
        <a class="navbar-brand" href="/promotions">
            <i class="fas fa-arrow-left"></i> Back to Promotions
        </a>
    </div>
</nav>

<div class="container">
    <div class="detail-container">
        <h2 class="mb-4">
            <i class="fas fa-envelope-open-text text-primary"></i> Promotion Details
        </h2>

        <!-- Status Badge -->
        <div class="status-badge"
             th:classappend="${promotion.status == 'SENT'} ? 'status-sent' :
                                 (${promotion.status == 'DRAFT'} ? 'status-draft' :
                                 (${promotion.status == 'SCHEDULED'} ? 'status-scheduled' : 'status-cancelled'))">
            <h3 class="mb-0">
                <i class="fas fa-circle-check" th:if="${promotion.status == 'SENT'}"></i>
                <i class="fas fa-file-lines" th:if="${promotion.status == 'DRAFT'}"></i>
                <i class="fas fa-clock" th:if="${promotion.status == 'SCHEDULED'}"></i>
                <i class="fas fa-ban" th:if="${promotion.status == 'CANCELLED'}"></i>
                Status: <span th:text="${promotion.status}">SENT</span>
            </h3>
            <p class="mb-0 mt-2" th:if="${promotion.status == 'SENT'}">
                This promotion has been successfully sent to <strong th:text="${promotion.recipientCount}">0</strong> recipients
            </p>
        </div>

        <!-- Email Details -->
        <div class="card mb-4">
            <div class="card-header bg-primary text-white">
                <h5 class="mb-0"><i class="fas fa-envelope"></i> Email Information</h5>
            </div>
            <div class="card-body">
                <div class="info-row">
                    <span class="info-label">Subject:</span>
                    <span class="info-value" th:text="${promotion.subject}">Subject</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Target Audience:</span>
                    <span class="badge bg-info" th:text="${promotion.targetAudience}">Audience</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Content:</span>
                </div>
                <div class="content-box">
                    <pre style="white-space: pre-wrap; font-family: inherit; margin: 0;" th:text="${promotion.content}">Email content here...</pre>
                </div>
            </div>
        </div>

        <!-- Discount Information (if applicable) -->
        <div class="card mb-4" th:if="${promotion.discountCode != null || promotion.discountPercentage != null}">
            <div class="card-header bg-success text-white">
                <h5 class="mb-0"><i class="fas fa-tag"></i> Discount Information</h5>
            </div>
            <div class="card-body">
                <div class="info-row" th:if="${promotion.discountCode != null}">
                    <span class="info-label">Discount Code:</span>
                    <code class="badge bg-warning text-dark fs-6" th:text="${promotion.discountCode}">CODE</code>
                </div>
                <div class="info-row" th:if="${promotion.discountPercentage != null}">
                    <span class="info-label">Discount Percentage:</span>
                    <strong class="text-success" th:text="${promotion.discountPercentage} + '%'">20%</strong>
                </div>
            </div>
        </div>

        <!-- Campaign Dates & Stats -->
        <div class="card mb-4">
            <div class="card-header bg-info text-white">
                <h5 class="mb-0"><i class="fas fa-calendar-alt"></i> Campaign Timeline & Statistics</h5>
            </div>
            <div class="card-body">
                <div class="info-row">
                    <span class="info-label">Created At:</span>
                    <span class="info-value" th:text="${#temporals.format(promotion.createdAt, 'MMMM dd, yyyy HH:mm')}">Date</span>
                </div>
                <div class="info-row" th:if="${promotion.scheduledDate != null}">
                    <span class="info-label">Scheduled For:</span>
                    <span class="info-value" th:text="${#temporals.format(promotion.scheduledDate, 'MMMM dd, yyyy HH:mm')}">Date</span>
                </div>
                <div class="info-row" th:if="${promotion.sentDate != null}">
                    <span class="info-label">Sent Date:</span>
                    <span class="info-value text-success">
                            <i class="fas fa-check-circle"></i>
                            <span th:text="${#temporals.format(promotion.sentDate, 'MMMM dd, yyyy HH:mm')}">Date</span>
                        </span>
                </div>
                <div class="info-row" th:if="${promotion.recipientCount > 0}">
                    <span class="info-label">Recipients:</span>
                    <span class="badge bg-primary" th:text="${promotion.recipientCount} + ' recipients'">0</span>
                </div>
                <div class="info-row">
                    <span class="info-label">Last Updated:</span>
                    <span class="info-value" th:text="${#temporals.format(promotion.updatedAt, 'MMMM dd, yyyy HH:mm')}">Date</span>
                </div>
            </div>
        </div>

        <!-- Action Buttons -->
        <div class="d-grid gap-2 d-md-flex justify-content-md-between mt-4">
            <a href="/promotions" class="btn btn-secondary btn-lg">
                <i class="fas fa-arrow-left"></i> Back to List
            </a>
            <div>
                <!-- Edit button - only show if not sent -->
                <a th:if="${promotion.status != 'SENT'}"
                   th:href="@{/promotions/edit/{id}(id=${promotion.id})}"
                   class="btn btn-warning btn-lg me-2">
                    <i class="fas fa-edit"></i> Edit
                </a>

                <!-- Send button - only show if not sent -->
                <a th:if="${promotion.status != 'SENT'}"
                   th:href="@{/promotions/send/{id}(id=${promotion.id})}"
                   class="btn btn-success btn-lg">
                    <i class="fas fa-paper-plane"></i> Send Now
                </a>

                <!-- View Analytics button - only show if sent -->
                <a th:if="${promotion.status == 'SENT'}"
                   href="/analytics"
                   class="btn btn-info btn-lg">
                    <i class="fas fa-chart-line"></i> View Analytics
                </a>
            </div>
        </div>

        <!-- Info Alert for Sent Promotions -->
        <div class="alert alert-info mt-4" th:if="${promotion.status == 'SENT'}">
            <i class="fas fa-info-circle"></i>
            <strong>Note:</strong> This promotion has been sent and cannot be edited or deleted.
            You can view its performance metrics in the Analytics section.
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>